<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trop Adventure</title>
<style>
  body { margin:0; overflow:hidden; background:#87CEEB; font-family:sans-serif; }
  canvas { display:block; }
  .controls {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 100;
  }
  .controls button {
    padding: 12px;
    font-size: 18px;
    border-radius: 6px;
    border:none;
    background: rgba(0,0,0,0.4);
    color:white;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div class="controls">
  <button onclick="playerMove(-1)">â—€</button>
  <button onclick="playerJump()">â–²</button>
  <button onclick="playerMove(1)">â–¶</button>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ðŸŒ´ Level Setup
const gravity = 0.5;
const player = { x:100, y:canvas.height-150, w:40, h:60, vy:0, onGround:false };
let keys = {};
const spikes = [];
const platforms = [];
const particles = [];
let gameOver = false;
let portal = { x:canvas.width-150, y:canvas.height-200, w:50, h:80 };

// ==== Tropical Jungle Background ====
function drawBackground(){
  // Himmel
  ctx.fillStyle = '#87CEEB';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Sonne
  ctx.fillStyle = '#FFD700';
  ctx.beginPath();
  ctx.arc(100,100,50,0,Math.PI*2);
  ctx.fill();

  // Wasser
  ctx.fillStyle = '#1E90FF';
  ctx.fillRect(0,canvas.height-100,canvas.width,100);

  // Sand
  ctx.fillStyle = '#EDC9AF';
  ctx.fillRect(0,canvas.height-50,canvas.width,50);

  // Palmen
  ctx.fillStyle = '#228B22';
  for(let i=0;i<5;i++){
    let px=i*200+50;
    ctx.fillRect(px,canvas.height-300,20,150); // Stamm
    ctx.beginPath();
    ctx.moveTo(px-30,canvas.height-300);
    ctx.lineTo(px+10,canvas.height-350);
    ctx.lineTo(px+50,canvas.height-300);
    ctx.fill();
  }
}

// ==== Platform & Spike Setup ====
platforms.push({x:0, y:canvas.height-50, w:canvas.width, h:50, open:false});
platforms.push({x:300, y:canvas.height-150, w:200, h:20, open:false});
platforms.push({x:600, y:canvas.height-250, w:150, h:20, open:false});

function spawnSpike(){
  const x = Math.random()*(canvas.width-20);
  spikes.push({x:x, y:-20, w:20, h:20, vy:2+Math.random()*3});
}

// ==== Particles ====
function createParticles(x,y,color){
  for(let i=0;i<20;i++){
    particles.push({
      x:x, y:y,
      vx:(Math.random()-0.5)*5,
      vy:(Math.random()-1.5)*5,
      alpha:1,
      color:color
    });
  }
}

// ==== Game Loop ====
function update(){
  if(gameOver){ drawGameOver(); return; }

  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBackground();

  // Plattform zeichnen
  ctx.fillStyle='#654321';
  platforms.forEach(p=>{
    if(!p.open) ctx.fillRect(p.x,p.y,p.w,p.h);
  });

  // Portal
  ctx.fillStyle='purple';
  ctx.fillRect(portal.x, portal.y, portal.w, portal.h);

  // Spieler
  player.vy += gravity;
  player.y += player.vy;

  // Kollision mit Plattformen
  player.onGround = false;
  platforms.forEach(p=>{
    if(player.x+player.w>p.x && player.x<p.x+p.w &&
       player.y+player.h>p.y && player.y+player.h< p.y+p.h+player.vy){
         player.y = p.y - player.h;
         player.vy = 0;
         player.onGround = true;
         // ZufÃ¤llige BodenÃ¶ffnung
         if(Math.random()<0.01) p.open=true;
       }
  });

  // Spieler zeichnen
  ctx.fillStyle='red';
  ctx.fillRect(player.x,player.y,player.w,player.h);

  // Spikes
  if(Math.random()<0.02) spawnSpike();
  spikes.forEach((s,i)=>{
    s.y += s.vy;
    ctx.fillStyle='black';
    ctx.fillRect(s.x,s.y,s.w,s.h);
    // Kollision Spieler
    if(player.x+player.w>s.x && player.x<s.x+s.w &&
       player.y+player.h>s.y && player.y<s.y+s.h){
         createParticles(player.x+player.w/2, player.y+player.h/2,'red');
         gameOver=true;
       }
    if(s.y>canvas.height) spikes.splice(i,1);
  });

  // Partikel
  particles.forEach((p,i)=>{
    ctx.fillStyle=p.color;
    ctx.globalAlpha = p.alpha;
    ctx.fillRect(p.x,p.y,5,5);
    p.x += p.vx;
    p.y += p.vy;
    p.vy += 0.1;
    p.alpha -=0.02;
    if(p.alpha<=0) particles.splice(i,1);
  });
  ctx.globalAlpha=1;

  // Portal Check
  if(player.x+player.w>portal.x && player.x<portal.x+portal.w &&
     player.y+player.h>portal.y && player.y<portal.y+portal.h){
       drawWin();
       return;
     }

  requestAnimationFrame(update);
}
function drawGameOver(){
  ctx.fillStyle='rgba(0,0,0,0.5)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle='white';
  ctx.font='50px sans-serif';
  ctx.fillText('Game Over',canvas.width/2-150,canvas.height/2);
}
function drawWin(){
  ctx.fillStyle='rgba(255,255,255,0.5)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle='green';
  ctx.font='50px sans-serif';
  ctx.fillText('Level Complete!',canvas.width/2-200,canvas.height/2);
}

// ==== Controls ====
function playerMove(dir){
  player.x += dir*5;
  if(player.x<0) player.x=0;
  if(player.x>canvas.width-player.w) player.x=canvas.width-player.w;
}
function playerJump(){
  if(player.onGround) player.vy=-12;
}

// Start Game
update();
</script>
</body>
</html>
