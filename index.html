<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Trop Adventure</title>
<style>
body { margin:0; overflow:hidden; background:#6ec6ff; }
canvas { display:block; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const gravity = 0.6;
const friction = 0.8;

let keys = {};

let player = {
    x: 100,
    y: 300,
    width: 30,
    height: 30,
    dx: 0,
    dy: 0,
    grounded: false
};

let platforms = [
    {x:0, y:400, width:canvas.width, height:50},
    {x:300, y:320, width:120, height:20},
    {x:500, y:260, width:120, height:20}
];

let spikes = [
    {x:650, y:380, size:20},
    {x:680, y:380, size:20}
];

function drawBackground(){
    // Himmel
    ctx.fillStyle = "#6ec6ff";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Sonne
    ctx.fillStyle = "yellow";
    ctx.beginPath();
    ctx.arc(100,100,50,0,Math.PI*2);
    ctx.fill();

    // Palmen
    for(let i=0;i<5;i++){
        ctx.fillStyle = "#8b5a2b";
        ctx.fillRect(150*i+50,350,20,80);
        ctx.fillStyle = "green";
        ctx.beginPath();
        ctx.arc(150*i+60,340,40,0,Math.PI*2);
        ctx.fill();
    }
}

function drawPlayer(){
    ctx.fillStyle = "black";
    ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawPlatforms(){
    ctx.fillStyle = "#228B22";
    platforms.forEach(p=>{
        ctx.fillRect(p.x,p.y,p.width,p.height);
    });
}

function drawSpikes(){
    ctx.fillStyle = "red";
    spikes.forEach(s=>{
        ctx.beginPath();
        ctx.moveTo(s.x, s.y);
        ctx.lineTo(s.x+10, s.y-20);
        ctx.lineTo(s.x+20, s.y);
        ctx.fill();
    });
}

function update(){
    player.dy += gravity;

    if(keys["ArrowRight"]) player.dx = 5;
    else if(keys["ArrowLeft"]) player.dx = -5;
    else player.dx *= friction;

    player.x += player.dx;
    player.y += player.dy;

    player.grounded = false;

    platforms.forEach(p=>{
        if(player.x < p.x + p.width &&
           player.x + player.width > p.x &&
           player.y < p.y + p.height &&
           player.y + player.height > p.y){

            player.y = p.y - player.height;
            player.dy = 0;
            player.grounded = true;
        }
    });

    if(player.grounded && keys[" "]){
        player.dy = -12;
    }

    spikes.forEach(s=>{
        if(player.x < s.x+20 &&
           player.x + player.width > s.x &&
           player.y + player.height > s.y-20){
            resetPlayer();
        }
    });

    if(player.y > canvas.height){
        resetPlayer();
    }
}

function resetPlayer(){
    player.x = 100;
    player.y = 300;
    player.dy = 0;
}

function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawBackground();
    drawPlatforms();
    drawSpikes();
    drawPlayer();
    update();
    requestAnimationFrame(gameLoop);
}

window.addEventListener("keydown", e=> keys[e.key]=true);
window.addEventListener("keyup", e=> keys[e.key]=false);

gameLoop();
</script>

</body>
</html>
